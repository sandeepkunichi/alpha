<html>
<head>
	<title>Alpha</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0" />

	<link rel="stylesheet" type="text/css" href="../css/bootstrap.css"/>
	<link rel="stylesheet" type="text/css" href="../css/animate.css"/>
	<link rel="stylesheet" type="text/css" href="../css/main.css"/>
	<link rel="stylesheet" type="text/css" href="../css/bootstrap.min.css">
	<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bootcards/1.0.0/css/bootcards-desktop.min.css">
	
	<script type="text/javascript" src="../js/jquery.js"></script>
	<script type="text/javascript" src="../js/wow.js"></script>
	<script type="text/javascript" src="../js/jquery.min.js"></script>
	<script type="text/javascript" src="../js/main.js"></script>	
    <script type="text/javascript" src="../js/bootstrap.min.js"></script> 
</head>
<body>
    <nav class="navbar navbar-default" role="navigation">
        <div class="container">
            <div class="navbar-brand navbar-brand-centered animated wow fadeInLeft pull-left" data-wow-delay="0s" style="color: #01838C;font-size: 34px; font-weight: bold; padding: 3%;">Alpha</div>
			<div class="navbar-brand navbar-brand-centered animated wow fadeInRight pull-right" data-wow-delay="0s" style="color: #01838C;font-size: 16px; font-weight: bold; padding: 3%;">suraj@test.com | <a href="logout" style="color: #01838C;font-size: 16px; font-weight: bold; padding: 3%;">LOGOUT</a></div>
        </div>
    </nav>
	<div class="main">
		<div class="container" style="background:#01838C" style="padding-top:0%">
			<div class="row">
				<div class="col-md-4 bootcards-list list1" style="padding:3%;" id="cardlist1"></div>
				<div class="col-md-4 bootcards-list" style="padding:3%;" id="cardlist2"></div>
				<div class="col-md-4 bootcards-list" style="padding:3%;" id="cardlist3"></div>
			</div>
		</div>
	</div>
	<footer>
		  <div class="container">
			 <div class="row">             
			 </div>                
        </div>
    </footer>
	<script>
		function sortDescending(a, b) {
			var date1  = $(a).find(".date").text();
			date1 = date1.split('-');
			date1 = new Date(date1[2], date1[1] -1, date1[0]);
			var date2  = $(b).find(".date").text();
			date2= date2.split('-');
			date2= new Date(date2[2], date2[1] -1, date2[0]);
			return date1 < date2 ? 1 : -1;
		};
		var ws = new WebSocket("ws://echo.websocket.org");
		ws.onopen = function()
		{
			var msg1 = {
				source: "TOI",
				title: "France in danger",
				date: 1447668487000,
				content:   "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Fusce accumsan fermentum tincidunt. Ut non posuere nibh. Suspendisse cursus, eros vitae cursus pulvinar, urna velit pellentesque nunc, sit amet dapibus orci nunc vel risus. Etiam euismod risus ac magna rhoncus vulputate. Etiam pellentesque faucibus tempus. Aliquam pulvinar rutrum lacus eu faucibus. Pellentesque commodo egestas laoreet. Nam et blandit elit. Phasellus at dui id felis dictum feugiat quis ac nunc. Nunc posuere, est vehicula placerat blandit, nisi elit aliquet eros, in hendrerit nisl dui a dui. Sed ac vestibulum metus..",
				image:   "",
				url: "https://toi.com"
			};
			var msg2 = {
				source: "Hindu",
				title: "Modi in UK",
				date: 1447582087000,
				content:   "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Fusce accumsan fermentum tincidunt. Ut non posuere nibh. Suspendisse cursus, eros vitae cursus pulvinar, urna velit pellentesque nunc, sit amet dapibus orci nunc vel risus. Etiam euismod risus ac magna rhoncus vulputate. Etiam pellentesque faucibus tempus. Aliquam pulvinar rutrum lacus eu faucibus. Pellentesque commodo egestas laoreet. Nam et blandit elit. Phasellus at dui id felis dictum feugiat quis ac nunc. Nunc posuere, est vehicula placerat blandit, nisi elit aliquet eros, in hendrerit nisl dui a dui. Sed ac vestibulum metus.",
				image:   "http://images.indianexpress.com/2013/01/modicameron-759.jpg",
				url: "https://hindu.com"
			};
			var msg3 = {
				source: "Apple",
				title: "iMoney unveiled",
				date: 1433671687000,
				content:   "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Fusce accumsan fermentum tincidunt. Ut non posuere nibh. Suspendisse cursus, eros vitae cursus pulvinar, urna velit pellentesque nunc, sit amet dapibus orci nunc vel risus. Etiam euismod risus ac magna rhoncus vulputate. Etiam pellentesque faucibus tempus. Aliquam pulvinar rutrum lacus eu faucibus. Pellentesque commodo egestas laoreet. Nam et blandit elit. Phasellus at dui id felis dictum feugiat quis ac nunc. Nunc posuere, est vehicula placerat blandit, nisi elit aliquet eros, in hendrerit nisl dui a dui. Sed ac vestibulum metus.",
				image:   "",
				url: "https://apple.com"
			};
			var msg1ToSend = JSON.stringify(msg1);
			var msg2ToSend = JSON.stringify(msg2);
			var msg3ToSend = JSON.stringify(msg3);
			ws.send(msg2ToSend);
			setTimeout(function(){
				ws.send(msg1ToSend);
				setTimeout(function(){
					ws.send(msg3ToSend);
					setTimeout(function(){
						ws.send(msg2ToSend);
							setTimeout(function(){
							ws.send(msg3ToSend);
							setTimeout(function(){
								ws.send(msg1ToSend);
								setTimeout(function(){
									ws.send(msg1ToSend);
										setTimeout(function(){
											ws.send(msg2ToSend);
											setTimeout(function(){
												ws.send(msg3ToSend);
												setTimeout(function(){
													ws.send(msg2ToSend);
												}, 3000);
											}, 3000);
										}, 3000);
								}, 3000);
							}, 3000);
						}, 3000);
					}, 3000);
				}, 3000);
			}, 2000);
		};
		ws.onmessage = function (evt) 
		{
			var received_msg = evt.data;
			var date = new Date(JSON.parse(received_msg).date);
			var day = date.getDate();
			var month = date.getMonth()+1;
			var year = date.getFullYear();
			var dateString = day+"-"+month+"-"+year;
			timeSince = getTimeSince(date);
			var card = '<div class="panel panel-default card card_one" id="newcard'+$(".card_one").length+'" data-wow-delay="0s"><div class="panel-heading clearfix"><h3 class="panel-title pull-left"><b>'+JSON.parse(received_msg).source+'</b></h3><h3 class="panel-title pull-right"><b>'+timeSince+' ago</b><p class="date" style="display:none;">'+dateString+'</p></h3></div><img src="'+JSON.parse(received_msg).image+'" class="img-responsive"/><div class="list-group"><div class="list-group-item"><h4 class="list-group-item-heading" style="font-size:12px;">'+JSON.parse(received_msg).content+'</h4></div></div><div class="panel-footer"><a target="_blank" href="'+JSON.parse(received_msg).url+'">'+JSON.parse(received_msg).url+'</a></div></div>';
			$(card).hide().appendTo('#cardlist1').fadeIn('slow');
			$('#cardlist1 .card').sort(sortDescending).appendTo('#cardlist1');
		};
		function getTimeSince(date) {
			var seconds = Math.floor((new Date() - date) / 1000);
			var interval = Math.floor(seconds / 31536000);
			if (interval > 1) {
				return interval + " years";
			}
			interval = Math.floor(seconds / 2592000);
			if (interval > 1) {
				return interval + " months";
			}
			interval = Math.floor(seconds / 86400);
			if (interval > 1) {
				return interval + " days";
			}
			interval = Math.floor(seconds / 3600);
			if (interval > 1) {
				return interval + " hours";
			}
			interval = Math.floor(seconds / 60);
			if (interval > 1) {
				return interval + " minutes";
			}
			return Math.floor(seconds) + " seconds";
		}
	</script>
</body>
</html>