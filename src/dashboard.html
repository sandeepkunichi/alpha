<html>
<head>
	<title>Alpha</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0" />

	<link rel="stylesheet" type="text/css" href="../css/bootstrap.css"/>
	<link rel="stylesheet" type="text/css" href="../css/animate.css"/>
	<link rel="stylesheet" type="text/css" href="../css/main.css"/>
	<link rel="stylesheet" type="text/css" href="../css/bootstrap.min.css">
	<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bootcards/1.0.0/css/bootcards-desktop.min.css">
	
	<script type="text/javascript" src="../js/jquery.js"></script>
	<script type="text/javascript" src="../js/wow.js"></script>
	<script type="text/javascript" src="../js/jquery.min.js"></script>
	<script type="text/javascript" src="../js/main.js"></script>	
    <script type="text/javascript" src="../js/bootstrap.min.js"></script> 
</head>
<body>
    <nav class="navbar navbar-default" role="navigation">
        <div class="container">
            <div class="navbar-brand navbar-brand-centered animated wow fadeInDown" data-wow-delay="0s" style="color: #01838C;font-size: 34px; font-weight: bold; padding: 3%;">Alpha</div>
        </div>
    </nav>
	<div class="main">
		<div class="container" style="background:#01838C" style="padding-top:0%">
			<div class="row">
				<div class="col-md-4 bootcards-list" style="padding:3%;" id="cardlist1"></div>
				<div class="col-md-4 bootcards-list" style="padding:3%;" id="cardlist2"></div>
				<div class="col-md-4 bootcards-list" style="padding:3%;" id="cardlist3"></div>
			</div>
		</div>
	</div>
	<footer>
		  <div class="container">
			 <div class="row">             
			 </div>                
        </div>
    </footer>
	<script>
		function sortDescending(a, b) {
			var date1  = $(a).find(".date").text();
			date1 = date1.split('-');
			date1 = new Date(date1[2], date1[1] -1, date1[0]);
			var date2  = $(b).find(".date").text();
			date2= date2.split('-');
			date2= new Date(date2[2], date2[1] -1, date2[0]);
			return date1 < date2 ? 1 : -1;
		};
		var ws = new WebSocket("ws://echo.websocket.org");
		ws.onopen = function()
		{
			var msg1 = {
				source: "TOI",
				title: "France in danger",
				date: Date.now(),
				content:   "Paris put on high alert after terror strikes.",
				image:   "",
				url: "https://toi.com"
			};
			var msg2 = {
				source: "Hindu",
				title: "Modi in UK",
				date: Date.now()+132171212123,
				content:   "Modi to have tea with the queen of England and her poodles.",
				image:   "http://images.indianexpress.com/2013/01/modicameron-759.jpg",
				url: "https://hindu.com"
			};
			var msg3 = {
				source: "Apple",
				title: "iMoney unveiled",
				date: Date.now()-3263721637,
				image:   "",
				url: "https://apple.com"
			};
			var msg1ToSend = JSON.stringify(msg1);
			var msg2ToSend = JSON.stringify(msg2);
			var msg3ToSend = JSON.stringify(msg3);
			ws.send(msg1ToSend);
			setTimeout(function(){
				ws.send(msg2ToSend);
				setTimeout(function(){
					ws.send(msg3ToSend);
				}, 3000);
			}, 2000);
		};
		ws.onmessage = function (evt) 
		{
			var received_msg = evt.data;
			var date = new Date(JSON.parse(received_msg).date);
			var day = date.getDate();
			var month = date.getMonth()+1;
			var year = date.getFullYear();
			var date = day+"-"+month+"-"+year;
			var card = '<div class="panel panel-default card animated wow fadeInLeft" id="newcard" data-wow-delay="0s"><div class="panel-heading clearfix"><h3 class="panel-title pull-left"><b>'+JSON.parse(received_msg).title+'</b></h3></div><img src="'+JSON.parse(received_msg).image+'" class="img-responsive"/><div class="list-group"><div class="list-group-item"><p class="list-group-item-text">Source</p><h4 class="list-group-item-heading">'+JSON.parse(received_msg).source+'</h4></div><div class="list-group-item"><p class="list-group-item-text">Date</p><h4 class="list-group-item-heading date">'+date+'</h4></div><div class="list-group-item"><p class="list-group-item-text">'+JSON.parse(received_msg).content+'</p></div></div><div class="panel-footer"><a target="_blank" href="'+JSON.parse(received_msg).url+'">'+JSON.parse(received_msg).url+'</a></div></div>';
			$('#cardlist1').append(card);
			$('#newcard').removeClass("animated wow fadeInLeft");
			//$('#cardlist2').append(card);
			//$('#cardlist3').append(card);
			$('#cardlist1 .card').sort(sortDescending).appendTo('#cardlist1');
			//$('#newcard').removeClass("animated wow fadeInDown");
			//$('#cardlist2 .card').sort(sortDescending).appendTo('#cardlist2');
			//$('#cardlist3 .card').sort(sortDescending).appendTo('#cardlist3');
		};
	</script>
</body>
</html>